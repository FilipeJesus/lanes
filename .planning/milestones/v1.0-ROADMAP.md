# Milestone v1.0: File Attachment Support

**Status:** SHIPPED 2026-02-09
**Phases:** 1
**Total Plans:** 2

## Overview

Add file attachment capability to the Lanes session creation form. Users click a paperclip button to select files via VS Code's native file picker, see selected files as a removable chip list, and have those file paths automatically included in the starting prompt when creating a session.

## Phases

### Phase 1: File Attachment UI & Integration

**Goal**: Users can attach files to their session starting prompt via a visual file picker and see those paths automatically included in the prompt.

**Depends on**: Nothing (first phase)

**Requirements**: UI-01, UI-02, PICK-01, PICK-02, PICK-03, DISP-01, DISP-02, DISP-03, DISP-04, DISP-05, INT-01, INT-02, INT-03

**Success Criteria** (what must be TRUE):
  1. User sees a paperclip button in the session form next to the starting prompt textarea
  2. User can click the button and select multiple files from the VS Code file picker dialog
  3. User sees selected files displayed as chips with filenames and "X" remove buttons
  4. User can remove individual files from the list by clicking the "X" button
  5. User can create a session and the starting prompt includes the full file paths in a formatted list

**Plans**: 2 plans

Plans:
- [x] 01-01-PLAN.md -- Attachment UI: paperclip button, file picker via message passing, chip list with remove, duplicate detection, state persistence
- [x] 01-02-PLAN.md -- Prompt assembly: format attachment paths into prompt, update callback chain, add tests

**Completed**: 2026-02-09

---

## Milestone Summary

**Key Decisions:**

- Paths only, not content: Claude can read files itself; embedding content would bloat prompts
- Extension-side file picker: VS Code API restriction — showOpenDialog unavailable in webview context
- Append paths as list to prompt: Clean format for Claude to parse; doesn't interfere with user's prompt text
- 20-file limit: Reasonable upper bound to prevent prompt bloat while allowing multiple file references
- Case-insensitive duplicate detection: Prevents accidental re-attachment on case-insensitive file systems
- Paperclip icon in textarea corner: Consistent with common attachment UX patterns
- Chip/tag style for attachment list: Compact display with file-type icons

**Issues Resolved:**

- Callback chain wiring across 4 files (form → extension → service → terminal)
- Webview ↔ extension message passing for file picker (can't call VS Code API from webview)
- HTML escaping for file paths in webview to prevent XSS

**Issues Deferred:**

- Direct unit tests for `assembleStartingPrompt` (currently tested indirectly)
- Path validation defense-in-depth (low risk due to CSP/VS Code protections)

**Technical Debt Incurred:**

- None significant — code review found 0 critical issues

---

_For current project status, see .planning/ROADMAP.md_
